{"file":"/Users/tttela/Documents/Work/denof/works/250529sokubutsu/dev2/src/domain/telegram/telegram.controller.ts","mappings":"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","names":[],"sources":["/Users/tttela/Documents/Work/denof/works/250529sokubutsu/dev2/src/domain/telegram/telegram.controller.ts"],"sourcesContent":["import { Controller, Post, Body, UseGuards, Logger } from '@nestjs/common';\nimport {\n  TelegramAuthGuard,\n  TelegramWebhookGuard,\n  RateLimitGuard,\n} from '../../common/guards';\nimport {\n  CurrentUser,\n  TelegramUser,\n  IsNewUser,\n} from '../../core/auth/decorators/telegram-user.decorator';\nimport { User } from '../users/entities/user.entity';\nimport {\n  TelegramUpdate,\n  TelegramUser as ITelegramUser,\n} from '../../common/interfaces';\nimport { AuthService } from '../../core/auth/auth.service';\nimport { TelegramService } from './telegram.service';\n\n@Controller('telegram')\nexport class TelegramController {\n  private readonly logger = new Logger(TelegramController.name);\n\n  constructor(\n    private readonly authService: AuthService,\n    private readonly telegramService: TelegramService,\n  ) {}\n\n  /**\n   * Telegram Webhook ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ\n   */\n  @Post('webhook')\n  @UseGuards(TelegramWebhookGuard, TelegramAuthGuard, RateLimitGuard)\n  async handleUpdate(\n    @Body() update: TelegramUpdate,\n    @CurrentUser() user: User,\n    @TelegramUser() telegramUser: ITelegramUser,\n    @IsNewUser() isNewUser: boolean,\n  ) {\n    this.logger.debug(`Received update: ${String(JSON.stringify(update))}`);\n\n    // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒãªã„å ´åˆã¯ç„¡è¦–\n    if (!update.message || !update.message.text) {\n      return { ok: true };\n    }\n\n    const chatId = update.message.chat.id;\n    const text = update.message.text;\n\n    // ã‚³ãƒãƒ³ãƒ‰ã®è§£æ\n    const command = this.parseCommand(text);\n\n    try {\n      switch (command.name) {\n        case '/start':\n          await this.handleStartCommand(chatId, telegramUser, isNewUser);\n          break;\n\n        case '/add':\n          await this.handleAddCommand(chatId, user, command.args);\n          break;\n\n        case '/list':\n          await this.handleListCommand(chatId, user);\n          break;\n\n        case '/remove':\n          await this.handleRemoveCommand(chatId, user, command.args);\n          break;\n\n        case '/pause':\n          await this.handlePauseCommand(chatId, user, command.args);\n          break;\n\n        case '/resume':\n          await this.handleResumeCommand(chatId, user, command.args);\n          break;\n\n        case '/status':\n          await this.handleStatusCommand(chatId, user);\n          break;\n\n        case '/help':\n          await this.handleHelpCommand(chatId);\n          break;\n\n        default:\n          await this.telegramService.sendMessage(\n            chatId,\n            'ä¸æ˜ãªã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚/help ã§ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚',\n          );\n      }\n    } catch (error) {\n      this.logger.error(`Command execution error:`, error);\n      await this.telegramService.sendMessage(\n        chatId,\n        'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚',\n      );\n    }\n\n    return { ok: true };\n  }\n\n  /**\n   * /start ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n   */\n  private async handleStartCommand(\n    chatId: number,\n    telegramUser: ITelegramUser,\n    _isNewUser: boolean,\n  ) {\n    const result = await this.authService.handleStartCommand(telegramUser);\n    await this.telegramService.sendMessage(chatId, result.welcomeMessage);\n  }\n\n  /**\n   * /add ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n   */\n  private async handleAddCommand(chatId: number, user: User, args: string[]) {\n    if (args.length === 0) {\n      await this.telegramService.sendMessage(\n        chatId,\n        'ä½¿ç”¨æ–¹æ³•: /add <URL>\\nä¾‹: /add https://www.example.com/property/123',\n      );\n      return;\n    }\n\n    const url = args[0];\n\n    // URLæ¤œè¨¼\n    if (!this.isValidUrl(url)) {\n      await this.telegramService.sendMessage(\n        chatId,\n        'æœ‰åŠ¹ãªURLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',\n      );\n      return;\n    }\n\n    // TODO: URLè¿½åŠ å‡¦ç†ã‚’å®Ÿè£…\n    await this.telegramService.sendMessage(\n      chatId,\n      `URL \"${url}\" ã‚’ç›£è¦–ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸï¼\\næ–°ç€ç‰©ä»¶ãŒè¦‹ã¤ã‹ã‚Šæ¬¡ç¬¬ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ã€‚`,\n    );\n  }\n\n  /**\n   * /list ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n   */\n  private async handleListCommand(chatId: number, _user: User) {\n    // TODO: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç›£è¦–URLä¸€è¦§ã‚’å–å¾—\n    const message = `\nğŸ“‹ ç›£è¦–ä¸­ã®URLä¸€è¦§:\n\n1. https://example.com/property/123\n   çŠ¶æ…‹: ğŸŸ¢ ç›£è¦–ä¸­\n   æœ€çµ‚ãƒã‚§ãƒƒã‚¯: 5åˆ†å‰\n\n2. https://example.com/property/456\n   çŠ¶æ…‹: â¸ï¸ ä¸€æ™‚åœæ­¢ä¸­\n   æœ€çµ‚ãƒã‚§ãƒƒã‚¯: 1æ™‚é–“å‰\n\nç™»éŒ²æ•°: 2ä»¶\n    `.trim();\n\n    await this.telegramService.sendMessage(chatId, message);\n  }\n\n  /**\n   * /remove ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n   */\n  private async handleRemoveCommand(\n    chatId: number,\n    user: User,\n    args: string[],\n  ) {\n    if (args.length === 0) {\n      await this.telegramService.sendMessage(\n        chatId,\n        'ä½¿ç”¨æ–¹æ³•: /remove <ç•ªå·>\\n/list ã§ç•ªå·ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚',\n      );\n      return;\n    }\n\n    const index = parseInt(args[0]);\n    if (isNaN(index)) {\n      await this.telegramService.sendMessage(\n        chatId,\n        'ç•ªå·ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',\n      );\n      return;\n    }\n\n    // TODO: URLå‰Šé™¤å‡¦ç†ã‚’å®Ÿè£…\n    await this.telegramService.sendMessage(\n      chatId,\n      `ç•ªå· ${String(index)} ã®URLã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚`,\n    );\n  }\n\n  /**\n   * /pause ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n   */\n  private async handlePauseCommand(chatId: number, user: User, args: string[]) {\n    if (args.length === 0) {\n      await this.telegramService.sendMessage(\n        chatId,\n        'ä½¿ç”¨æ–¹æ³•: /pause <ç•ªå·>\\n/list ã§ç•ªå·ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚',\n      );\n      return;\n    }\n\n    const index = parseInt(args[0]);\n    if (isNaN(index)) {\n      await this.telegramService.sendMessage(\n        chatId,\n        'ç•ªå·ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',\n      );\n      return;\n    }\n\n    // TODO: ç›£è¦–ä¸€æ™‚åœæ­¢å‡¦ç†ã‚’å®Ÿè£…\n    await this.telegramService.sendMessage(\n      chatId,\n      `ç•ªå· ${String(index)} ã®ç›£è¦–ã‚’ä¸€æ™‚åœæ­¢ã—ã¾ã—ãŸã€‚`,\n    );\n  }\n\n  /**\n   * /resume ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n   */\n  private async handleResumeCommand(\n    chatId: number,\n    user: User,\n    args: string[],\n  ) {\n    if (args.length === 0) {\n      await this.telegramService.sendMessage(\n        chatId,\n        'ä½¿ç”¨æ–¹æ³•: /resume <ç•ªå·>\\n/list ã§ç•ªå·ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚',\n      );\n      return;\n    }\n\n    const index = parseInt(args[0]);\n    if (isNaN(index)) {\n      await this.telegramService.sendMessage(\n        chatId,\n        'ç•ªå·ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',\n      );\n      return;\n    }\n\n    // TODO: ç›£è¦–å†é–‹å‡¦ç†ã‚’å®Ÿè£…\n    await this.telegramService.sendMessage(\n      chatId,\n      `ç•ªå· ${String(index)} ã®ç›£è¦–ã‚’å†é–‹ã—ã¾ã—ãŸã€‚`,\n    );\n  }\n\n  /**\n   * /status ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n   */\n  private async handleStatusCommand(chatId: number, user: User) {\n    // TODO: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç›£è¦–çŠ¶æ³ã‚’å–å¾—\n    const message = `\nğŸ“Š ç›£è¦–çŠ¶æ³:\n\nğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼: ${user.fullName}\nğŸ“… ç™»éŒ²æ—¥: ${user.createdAt.toLocaleDateString('ja-JP')}\nğŸ” ç›£è¦–ä¸­URL: 2ä»¶\nâ¸ï¸ ä¸€æ™‚åœæ­¢ä¸­: 1ä»¶\nğŸ”” é€šçŸ¥è¨­å®š: ${user.settings?.notifications.enabled ? 'ON' : 'OFF'}\n\næœ€çµ‚ãƒã‚§ãƒƒã‚¯: 5åˆ†å‰\næ¬¡å›ãƒã‚§ãƒƒã‚¯: 10åˆ†å¾Œ\n    `.trim();\n\n    await this.telegramService.sendMessage(chatId, message);\n  }\n\n  /**\n   * /help ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n   */\n  private async handleHelpCommand(chatId: number) {\n    const message = `\nğŸ“š ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§:\n\n/start - ãƒœãƒƒãƒˆã‚’é–‹å§‹\n/add <URL> - ç›£è¦–URLã‚’è¿½åŠ \n/list - ç™»éŒ²URLä¸€è¦§ã‚’è¡¨ç¤º\n/remove <ç•ªå·> - URLã‚’å‰Šé™¤\n/pause <ç•ªå·> - ç›£è¦–ã‚’ä¸€æ™‚åœæ­¢\n/resume <ç•ªå·> - ç›£è¦–ã‚’å†é–‹\n/status - ç›£è¦–çŠ¶æ³ã‚’ç¢ºèª\n/help - ã“ã®ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º\n\nâ“ ä½¿ã„æ–¹:\n1. /add ã§URLã‚’ç™»éŒ²\n2. æ–°ç€ç‰©ä»¶ãŒã‚ã‚Œã°è‡ªå‹•é€šçŸ¥\n3. /list ã§ç™»éŒ²çŠ¶æ³ã‚’ç¢ºèª\n\nãŠå›°ã‚Šã®å ´åˆã¯ @sokubutsu_support ã¾ã§ã”é€£çµ¡ãã ã•ã„ã€‚\n    `.trim();\n\n    await this.telegramService.sendMessage(chatId, message);\n  }\n\n  /**\n   * ã‚³ãƒãƒ³ãƒ‰ã‚’ãƒ‘ãƒ¼ã‚¹\n   */\n  private parseCommand(text: string): { name: string; args: string[] } {\n    const parts = text.trim().split(/\\s+/);\n    const name = parts[0].toLowerCase();\n    const args = parts.slice(1);\n\n    return { name, args };\n  }\n\n  /**\n   * URLæ¤œè¨¼\n   */\n  private isValidUrl(url: string): boolean {\n    try {\n      new URL(url);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n}\n"],"version":3}